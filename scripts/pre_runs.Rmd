---
title: "Untitled"
author: "Annon. Reviewer"
date: "2024-03-21"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(here)
```


# Load data

```{r}

missing_sp <- read.csv("~/Library/CloudStorage/OneDrive-UBC/Data/dbem/missing_runs_yulia/missing_sp.csv") %>% 
  group_by(taxonkey,model) %>% 
  tally()


# Get lisf of available distributions
distributions <- list.files("~/Library/CloudStorage/OneDrive-UBC/Data/Species/Distributions/")

distributions <- str_sub(distributions,2,7)

```

# Prepare data for runs

## Create species files

```{r}


missing_distributions <- missing_sp %>% 
  filter(!taxonkey %in% distributions)

write_csv(missing_distributions, "../data/missing_distributions.csv")

# GFDL file (manually add 600004 at the end x 2)
gfdl_spp_list <- missing_sp %>% 
  filter(taxonkey %in% distributions) %>% 
  filter(model == "GFDL") %>% 
  select(taxonkey)
    
    name <- paste0(here(),"/data/species/MisGSppList10.txt")
    write.table(gfdl_spp_list, file=name, sep="\t", col.names = F, row.names = F)
  
# IPSL file 
ipsl_spp_list <- missing_sp %>% 
  filter(taxonkey %in% distributions) %>% 
  filter(model == "IPSL") %>% 
  select(taxonkey)
    
    name <- paste0(here(),"/data/species/MisISppList10",".txt")
    write.table(ipsl_spp_list, file=name, sep="\t", col.names = F, row.names = F)

```

